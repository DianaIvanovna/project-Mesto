{"code":"!function(e){var t={};function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var s in e)n.d(o,s,function(t){return e[t]}.bind(null,s));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=1)}([function(e,t){throw new Error(\"Module parse failed: Unexpected character '@' (1:0)\\nYou may need an appropriate loader to handle this file type, currently no loaders are configured to process this file. See https://webpack.js.org/concepts#loaders\\n> @import url(../vendor/normalize.css);\\n| @import url(../vendor/fonts.css);\\n| @import url(../blocks/root/root.css);\")},function(e,t,n){\"use strict\";n.r(t);class o{constructor(e){this.options=e}loadingUserInformation(){return fetch(`${this.options.baseUrl}/users/me`,{headers:this.options.headers}).then(e=>e.ok?e.json():e.status)}LoadingInitialCards(){return fetch(`${this.options.baseUrl}/cards`,{headers:this.options.headers}).then(e=>e.ok?e.json():Promise.reject(e.status))}UX(e,t){let n=\"\";e?(n=t.textContent,t.textContent=\"Загрузка...\"):t.textContent=n}editUserInformation(e,t){return fetch(`${this.options.baseUrl}/users/me`,{method:\"PATCH\",headers:this.options.headers,body:JSON.stringify({name:e,about:t})})}addCardServer(e,t){return fetch(`${this.options.baseUrl}/cards`,{method:\"POST\",headers:this.options.headers,body:JSON.stringify({name:e,link:t})}).then(e=>e.ok?e.json():Promise.reject(e.status))}deleteCard(e){fetch(`${this.options.baseUrl}/cards/${e}`,{method:\"DELETE\",headers:this.options.headers}).then(e=>{e.ok||console.log(e.status)})}settingAndRemovingLikes(e,t){return t?fetch(`${this.options.baseUrl}/cards/like/${e}`,{method:\"PUT\",headers:this.options.headers}).then(e=>e.ok?e.json():Promise.reject(e.status)):fetch(`${this.options.baseUrl}/cards/like/${e}`,{method:\"DELETE\",headers:this.options.headers}).then(e=>e.ok?e.json():Promise.reject(e.status))}}class s{constructor(e,t){this.api=t,this.cardData=e,this.link=e.link,this.name=e.name,this.likes=e.likes,this.like=this.like.bind(this),this.remove=this.remove.bind(this),this._setHandlers=this._setHandlers.bind(this)}_setHandlers(e){e.querySelector(\".place-card__like-icon\").addEventListener(\"click\",this.like),e.querySelector(\".place-card__delete-icon\").addEventListener(\"click\",this.remove)}like(e){const t=!e.target.classList.contains(\"place-card__like-icon_liked\");this.api.settingAndRemovingLikes(this.cardData._id,t).then(e=>{this.card.querySelector(\".place-card__like-value\").textContent=e.likes.length}).catch(e=>{console.log(e)}),e.target.classList.toggle(\"place-card__like-icon_liked\")}remove(){window.confirm(\"Вы действительно хотите удалить эту карточку?\")&&(this.api.deleteCard(this.cardData._id),this.card.parentNode.removeChild(this.card))}create(e){const t=document.createElement(\"div\");t.classList.add(\"place-card\"),t.innerHTML='\\n       <div class=\"place-card__image\">\\n       <button class=\"place-card__delete-icon\"></button>\\n       </div>\\n       <div class=\"place-card__description\">\\n       <h3 class=\"place-card__name\"></h3>\\n       <div class=\"place-card__like\">\\n       <button class=\"place-card__like-icon\"></button>\\n       <div class=\"place-card__like-value\">0</div>\\n       </div>\\n       </div>',t.querySelector(\".place-card__name\").textContent=e.name,t.querySelector(\".place-card__image\").style.backgroundImage=`url(${e.link})`,t.querySelector(\".place-card__like-value\").textContent=e.likes.length;return this.likes.some(e=>{if(e.name==document.querySelector(\".user-info__name\").textContent&&e.about==document.querySelector(\".user-info__job\").textContent)return t.querySelector(\".place-card__like-icon\").classList.add(\"place-card__like-icon_liked\"),!0}),this._setHandlers(t),this.card=t,t}}class r{constructor(e,t,n){this.api=n,this.container=e,this.createCard=t}addCard(e,...t){const n=this.createCard(e).create(e);1===t[0]&&n.querySelector(\".place-card__delete-icon\").classList.add(\"delete-icon_active\"),this.container.insertBefore(n,this.container.querySelector(\".place-card\"))}render(){this.api.LoadingInitialCards().then(e=>{for(const t of e)this.addCard(t)}).catch(e=>{console.log(`Ошибка: ${e}`)})}}class i{constructor(e){this.form=e,this.setEventListeners(this.form)}checkInputValidity(e){this.validForm(e.target.parentElement),this.resetError(e.target.parentElement,e.target),this.validElem(e.target,e.target.parentElement)}setSubmitButtonState(e){e.preventDefault(),this.validForm(this.form)}setEventListeners(e){const t=e.elements[0],n=e.elements[1];e.querySelector(\".popup__button\").addEventListener(\"click\",this.setSubmitButtonState.bind(this)),t.addEventListener(\"input\",this.checkInputValidity.bind(this)),n.addEventListener(\"input\",this.checkInputValidity.bind(this))}resetError(e,t){e.querySelector(`.error__${t.name}`).textContent=\"\"}validElem(e,t){const n=t.querySelector(`.error__${e.name}`),o=\"Должно быть от 2 до 30 символов\",s=\"Это обязательное поле\";return!!e.checkValidity()||(e.value?e.classList.contains(\".popup__input_type_link-url\")||(n.textContent=o):n.textContent=s,!1)}validForm(e){const t=Array.from(e);let n=!0;t.forEach(t=>{t.classList.contains(\"popup__input\")&&(this.validElem(t,e)||(n=!1))}),this.setSubmitButton(n,e)}setSubmitButton(e,t){const n=t.querySelector(\".popup__button\");e?n.classList.add(\"button_active\"):n.classList.remove(\"button_active\")}}class a{constructor(e,t){this.popup=e,this.popupClose=e.querySelector(\".popup__close\"),this.popupOpen=t,this.popupButton=e.querySelector(\".popup__button\"),this.openAndCloseForm=this.openAndCloseForm.bind(this),this.setEventListeners()}openAndCloseForm(){event.target.classList.contains(\"popup__button\")?event.target.classList.contains(\"button_active\")&&(this.popupButton.classList.remove(\"button_active\"),this.popup.classList.remove(\"popup_is-opened\")):(this.popupButton.classList.remove(\"button_active\"),this.popup.classList.toggle(\"popup_is-opened\"))}setEventListeners(){this.popupOpen.addEventListener(\"click\",this.openAndCloseForm),this.popupClose.addEventListener(\"click\",this.openAndCloseForm),this.popupButton.addEventListener(\"click\",this.openAndCloseForm)}}!function(){const e=document.querySelector(\".popup__close_image\"),t=()=>document.querySelector(\".popup_image\").classList.toggle(\"popup_is-opened\");window.addEventListener(\"click\",(function(e){e.target.classList.contains(\"place-card__image\")&&(e=>{const n=document.querySelector(\".popup__image\"),o=(e=>{const t=e.target.style.backgroundImage;return t.substr(5,t.length-7)})(e);n.setAttribute(\"src\",o),t()})(e)})),e.addEventListener(\"click\",t)}();class c{constructor(e,t){this.api=t,this.divUserInfo=e,this.nameElement=this.divUserInfo.querySelector(\".user-info__name\"),this.jobElement=this.divUserInfo.querySelector(\".user-info__job\"),this.nameElementContent=this.nameElement.textContent,this.jobElementContent=this.jobElement.textContent}setUserInfo(e,t,n){this.api.UX(!0,n),this.api.editUserInformation(e,t).then(e=>{e.ok||console.log(`Ошибка: ${e.status}`)}).finally(()=>{this.api.UX(!1,n)}),this.nameElementContent=e,this.jobElementContent=t}updateUserInfo(){this.nameElement.textContent=this.nameElementContent,this.jobElement.textContent=this.jobElementContent}}n(0);!function(){const e=new o({baseUrl:\"https://praktikum.tk/cohort7\",headers:{authorization:\"733ad404-17c3-485d-9074-456390901feb\",\"Content-Type\":\"application/json\"}});e.loadingUserInformation().then(e=>{!function(e){const t=document.querySelector(\".user-info__name\"),n=document.querySelector(\".user-info__job\"),o=document.querySelector(\".user-info__photo\");t.textContent=e.name,n.textContent=e.about,o.style=`background-image: url(${e.avatar});`}(e)}).catch(e=>{console.log(`Ошибка: ${e}`)}),function(){const t=document.querySelector(\".places-list\"),n=new r(t,t=>new s(t,e),e);n.render();const o=document.querySelector(\".popup__button\");o.addEventListener(\"click\",(function(){event.preventDefault();const t=document.forms.new,s=t.elements.name,r=t.elements.link;document.querySelector(\".popup\");event.target.classList.contains(\"button_active\")&&(!function(t,o,s){e.UX(!0,s),e.addCardServer(t,o).then(e=>{n.addCard(e,1)}).catch(e=>{console.log(`Ошибка: ${e}`)}).finally(()=>{e.UX(!1,s)})}(s.value,r.value,o),t.reset())}));const i=document.querySelector(\".popup\"),c=document.querySelector(\".user-info__button\"),l=(new a(i,c),document.querySelector(\".popup_edit-profile\")),u=document.querySelector(\".user-info__button-edit\");new a(l,u)}(),function(){const t=document.querySelector(\".popup__form_new\"),n=(new i(t),document.querySelector(\".popup__form_editProfile\")),o=(new i(n),document.querySelector(\".user-info\")),s=new c(o,e),r=n.elements.name,a=n.elements.job,l=document.querySelector(\".popup_edit-profile .popup__button\"),u=document.querySelector(\".user-info__button-edit\");l.addEventListener(\"click\",(function(){event.preventDefault(),s.setUserInfo(r.value,a.value,l),s.updateUserInfo()})),u.addEventListener(\"click\",(function(){r.value=document.querySelector(\".user-info__name\").textContent,a.value=document.querySelector(\".user-info__job\").textContent}))}()}()}]);","extractedComments":[]}